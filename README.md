# LangChain4j Study - å¤§æ¨¡å‹å·¥å…·è°ƒç”¨ç¤ºä¾‹

è¿™æ˜¯ä¸€ä¸ªç”¨äºå­¦ä¹ LangChain4jçš„Spring Booté¡¹ç›®ï¼Œé›†æˆäº†æœ¬åœ°OllamaæœåŠ¡ï¼Œæä¾›AIå·¥å…·è°ƒç”¨åŠŸèƒ½ç¤ºä¾‹ã€‚

**Package**: `com.cnblogs.yjmyzz.langchain4j.study`

## ğŸš€ é¡¹ç›®ç‰¹æ€§

- **Java 25**: ä½¿ç”¨æœ€æ–°çš„Javaç‰ˆæœ¬
- **Spring Boot 4.0.0**: ç°ä»£åŒ–çš„Spring Bootæ¡†æ¶
- **LangChain4j 1.8.0**: å¼ºå¤§çš„Java AIæ¡†æ¶
- **Ollamaé›†æˆ**: æ”¯æŒæœ¬åœ°å¤§è¯­è¨€æ¨¡å‹
- **å·¥å…·è°ƒç”¨**: æ”¯æŒAIè°ƒç”¨è‡ªå®šä¹‰å·¥å…·ï¼ˆå¦‚è®¢å•æŸ¥è¯¢ï¼‰
- **RESTful API**: æä¾›å®Œæ•´çš„å·¥å…·è°ƒç”¨APIæ¥å£
- **å®Œæ•´æµ‹è¯•**: åŒ…å«å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

## ğŸ“‹ å‰ç½®è¦æ±‚

1. **Java 25**: ç¡®ä¿å·²å®‰è£…JDK 25
2. **Maven 3.6+**: ç¡®ä¿å·²å®‰è£…Maven
3. **Ollama**: ç¡®ä¿å·²å®‰è£…å¹¶å¯åŠ¨OllamaæœåŠ¡

## ğŸ› ï¸ å®‰è£…å’Œé…ç½®

### 1. å®‰è£…Ollama

è®¿é—® [Ollamaå®˜ç½‘](https://ollama.ai/) ä¸‹è½½å¹¶å®‰è£…Ollamaã€‚

### 2. å¯åŠ¨OllamaæœåŠ¡

```bash
# å¯åŠ¨OllamaæœåŠ¡
ollama serve
```

### 3. ä¸‹è½½æ¨¡å‹

```bash
# ä¸‹è½½deepseek-v3.1:671b-cloudæ¨¡å‹ï¼ˆé»˜è®¤æ¨¡å‹ï¼‰
ollama pull deepseek-v3.1:671b-cloud

# æˆ–è€…ä¸‹è½½å…¶ä»–æ¨¡å‹
ollama pull qwen3:0.6b
ollama pull llama2
ollama pull llama2:7b
ollama pull llama2:13b
```

### 4. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/yjmyzz/langchain4j-study.git
cd langchain4j-study
```

### 5. ç¼–è¯‘é¡¹ç›®

```bash
mvn clean compile
```

### 6. è¿è¡Œé¡¹ç›®

```bash
mvn spring-boot:run
```

## ğŸŒ ä½¿ç”¨æ–¹å¼

### APIæ¥å£

#### å·¥å…·è°ƒç”¨åŠŸèƒ½

##### æŸ¥è¯¢è®¢å•çŠ¶æ€

```bash
# ç›´æ¥è°ƒç”¨å·¥å…·ï¼ˆä¸é€šè¿‡AIï¼‰
curl "http://localhost:8080/api/order/status/direct?orderId=12345"

# é€šè¿‡Ollamaæ¨¡å‹è°ƒç”¨å·¥å…·ï¼ˆAIè¾…åŠ©åˆ†æï¼‰
curl "http://localhost:8080/api/order/status/ollama?orderId=12345"
```

**è¯´æ˜**ï¼š
- `direct`: ç›´æ¥è°ƒç”¨å·¥å…·æ–¹æ³•ï¼Œè¿”å›åŸå§‹ç»“æœ
- `ollama`: å…ˆè°ƒç”¨å·¥å…·è·å–ç»“æœï¼Œç„¶åé€šè¿‡AIæ¨¡å‹åˆ†æå¹¶ç»™å‡ºç”¨æˆ·å‹å¥½çš„å›å¤

#### å¥åº·æ£€æŸ¥

```bash
# è®¢å•æœåŠ¡å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/order/health
```

## âš™ï¸ é…ç½®è¯´æ˜

é¡¹ç›®é…ç½®æ–‡ä»¶ä½äº `src/main/resources/application.yml`ï¼š

```yaml
# æœåŠ¡å™¨é…ç½®
server:
  port: 8080

# Springåº”ç”¨é…ç½®
spring:
  application:
    name: langchain4j-study
  
  # æ—¥å¿—é…ç½®
  logging:
    level:
      com.cnblogs.yjmyzz.langchain4j.study: DEBUG
      dev.langchain4j: DEBUG
    pattern:
      console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Ollamaé…ç½®
ollama:
  base-url: http://localhost:11434  # OllamaæœåŠ¡åœ°å€
  model: deepseek-v3.1:671b-cloud    # ä½¿ç”¨çš„æ¨¡å‹åç§°
  timeout: 60                       # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

# åº”ç”¨ä¿¡æ¯
info:
  app:
    name: langchain4j Study
    version: 1.0.0
    description: LangChain4jå­¦ä¹ é¡¹ç›® - Tool Calling
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/com/cnblogs/yjmyzz/langchain4j/study/
â”‚   â”‚   â”œâ”€â”€ LangChain4jStudyApplication.java    # ä¸»å¯åŠ¨ç±»
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ OllamaConfig.java              # Ollamaé…ç½®ç±»
â”‚   â”‚   â”‚   â””â”€â”€ OrderToolConfig.java           # è®¢å•å·¥å…·é…ç½®ç±»
â”‚   â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”‚   â””â”€â”€ OrderController.java           # è®¢å•æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ tools/
â”‚   â”‚       â””â”€â”€ OrderTools.java                # è®¢å•å·¥å…·ç±»
â”‚   â””â”€â”€ resources/
â”‚       â””â”€â”€ application.yml                     # åº”ç”¨é…ç½®
â””â”€â”€ test/
    â””â”€â”€ java/com/cnblogs/yjmyzz/langchain4j/study/
        â””â”€â”€ LangChain4jStudyApplicationTests.java  # åº”ç”¨æµ‹è¯•
```

## ğŸ“¦ Packageç»“æ„

é¡¹ç›®ä½¿ç”¨æ ‡å‡†çš„Maven packageå‘½åè§„èŒƒï¼š
- **GroupId**: `com.yjmyzz`
- **ArtifactId**: `langchain4j-study`
- **Version**: `1.0.0`
- **Package**: `com.cnblogs.yjmyzz.langchain4j.study`
- **ä¸»ç±»**: `LangChain4jStudyApplication`

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯´æ˜

### 1. é…ç½®ç±»

#### OllamaConfig.java
- é…ç½®OllamaèŠå¤©æ¨¡å‹å’Œæµå¼èŠå¤©æ¨¡å‹
- æ”¯æŒè‡ªå®šä¹‰æ¨¡å‹åç§°ã€æœåŠ¡åœ°å€å’Œè¶…æ—¶æ—¶é—´
- å¯ç”¨è¯·æ±‚å’Œå“åº”æ—¥å¿—è®°å½•
- ä½¿ç”¨ `@Bean` æ³¨è§£æ³¨å†Œä¸ºSpring Beanï¼Œæ”¯æŒä¾èµ–æ³¨å…¥

#### OrderToolConfig.java
- é…ç½®è®¢å•å·¥å…·çš„æ³¨å†Œå’Œç®¡ç†
- å°† `OrderTools` æ³¨å†Œä¸ºSpring Bean
- æ”¯æŒå·¥å…·åœ¨AIæ¨¡å‹ä¸­çš„é›†æˆ

### 2. æ§åˆ¶å™¨

#### OrderController.java
- æä¾›è®¢å•ç›¸å…³çš„RESTful APIæ¥å£
- æ”¯æŒç›´æ¥å·¥å…·è°ƒç”¨ï¼ˆä¸é€šè¿‡AIï¼‰
- æ”¯æŒAIè¾…åŠ©å·¥å…·è°ƒç”¨ï¼ˆé€šè¿‡Ollamaæ¨¡å‹åˆ†æå·¥å…·ç»“æœï¼‰
- åŒ…å«å¥åº·æ£€æŸ¥ç«¯ç‚¹
- ä½¿ç”¨ `@Qualifier` æ³¨å…¥æŒ‡å®šçš„Ollamaæ¨¡å‹å®ä¾‹

### 3. å·¥å…·ç±»

#### OrderTools.java
- æä¾›è®¢å•çŠ¶æ€æŸ¥è¯¢åŠŸèƒ½
- ä½¿ç”¨ `@Tool` æ³¨è§£æ ‡è®°ä¸ºAIå¯è°ƒç”¨çš„å·¥å…·
- ä½¿ç”¨ `@P` æ³¨è§£æè¿°å·¥å…·å‚æ•°
- å®ç°æ ‡å‡†åŒ–çš„å·¥å…·è§„èŒƒï¼Œç¬¦åˆLangChain4jå·¥å…·è°ƒç”¨è§„èŒƒ

### 4. ä¸»è¦ä¾èµ–
- **Spring Boot Web**: Webåº”ç”¨æ”¯æŒ
- **Spring Boot Validation**: æ•°æ®éªŒè¯æ”¯æŒ
- **Spring WebFlux**: å“åº”å¼ç¼–ç¨‹æ”¯æŒ
- **LangChain4j**: AIæ¡†æ¶æ ¸å¿ƒï¼ˆç‰ˆæœ¬ 1.8.0ï¼‰
- **LangChain4j Ollama**: Ollamaé›†æˆ
- **Lombok**: ä»£ç ç®€åŒ–å·¥å…·ï¼ˆæ³¨æ„ï¼šç”±äºJava 25å…¼å®¹æ€§é—®é¢˜ï¼Œé¡¹ç›®å·²ç§»é™¤Lombokæ³¨è§£å¤„ç†å™¨çš„ä½¿ç”¨ï¼‰

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
mvn test
```

### è¿è¡Œç‰¹å®šæµ‹è¯•

```bash
mvn test -Dtest=com.cnblogs.yjmyzz.langchain4j.study.LangChain4jStudyApplicationTests
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å·¥å…·

1. åˆ›å»ºå·¥å…·ç±»ï¼Œä½¿ç”¨ `@Tool` æ³¨è§£æ ‡è®°æ–¹æ³•
2. ä½¿ç”¨ `@P` æ³¨è§£æè¿°æ–¹æ³•å‚æ•°
3. åœ¨é…ç½®ç±»ä¸­æ³¨å†Œå·¥å…·ä¸ºSpring Beanï¼ˆå‚è€ƒ `OrderToolConfig.java`ï¼‰
4. åœ¨æ§åˆ¶å™¨ä¸­å®ç°å·¥å…·è°ƒç”¨æ¥å£
5. æ”¯æŒç›´æ¥è°ƒç”¨å’ŒAIè¾…åŠ©è°ƒç”¨ä¸¤ç§æ–¹å¼

**ç¤ºä¾‹**ï¼š
```java
public class MyTools {
    @Tool("å·¥å…·æè¿°")
    public String myMethod(@P("å‚æ•°æè¿°") String param) {
        // å®ç°å·¥å…·é€»è¾‘
        return "ç»“æœ";
    }
}
```

### æ‰©å±•å·¥å…·è°ƒç”¨åŠŸèƒ½

1. åœ¨æ§åˆ¶å™¨ä¸­æ·»åŠ æ–°çš„å·¥å…·è°ƒç”¨ç«¯ç‚¹
2. å®ç°ç›´æ¥è°ƒç”¨å’ŒAIè¾…åŠ©è°ƒç”¨ä¸¤ç§æ–¹å¼
3. ä½¿ç”¨ `@Qualifier` æ³¨å…¥æŒ‡å®šçš„æ¨¡å‹å®ä¾‹
4. æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### è‡ªå®šä¹‰é…ç½®

å¯ä»¥é€šè¿‡ä¿®æ”¹ `application.yml` æ¥è°ƒæ•´ï¼š
- OllamaæœåŠ¡é…ç½®
  - æœåŠ¡åœ°å€ï¼ˆ`ollama.base-url`ï¼‰
  - ä½¿ç”¨çš„æ¨¡å‹ï¼ˆ`ollama.model`ï¼‰
  - è¶…æ—¶æ—¶é—´ï¼ˆ`ollama.timeout`ï¼Œå•ä½ï¼šç§’ï¼‰
- æ—¥å¿—çº§åˆ«å’Œæ ¼å¼
- æœåŠ¡å™¨ç«¯å£ï¼ˆé»˜è®¤8080ï¼‰

**æ³¨æ„**: 
- æ—¥å¿—é…ç½®ä¸­çš„packageè·¯å¾„ä¸º `com.cnblogs.yjmyzz.langchain4j.study`
- ä¿®æ”¹é…ç½®åéœ€è¦é‡å¯åº”ç”¨æ‰èƒ½ç”Ÿæ•ˆ

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Ollamaè¿æ¥å¤±è´¥**
   - ç¡®ä¿OllamaæœåŠ¡å·²å¯åŠ¨ï¼š`ollama serve`
   - æ£€æŸ¥ç«¯å£11434æ˜¯å¦è¢«å ç”¨
   - éªŒè¯æ¨¡å‹æ˜¯å¦å·²ä¸‹è½½ï¼š`ollama list`

2. **æ¨¡å‹å“åº”ç¼“æ…¢**
   - æ£€æŸ¥ç¡¬ä»¶èµ„æºï¼ˆCPUã€å†…å­˜ï¼‰
   - è€ƒè™‘ä½¿ç”¨æ›´å°çš„æ¨¡å‹
   - è°ƒæ•´è¶…æ—¶é…ç½®
   - å¯¹äºæœ¬åœ°æ¨¡å‹ï¼Œè€ƒè™‘ä½¿ç”¨GPUåŠ é€Ÿ

3. **å†…å­˜ä¸è¶³**
   - å¢åŠ JVMå †å†…å­˜ï¼š`-Xmx4g`
   - ä½¿ç”¨æ›´å°çš„æ¨¡å‹
   - ä¼˜åŒ–æ‰¹å¤„ç†å¤§å°

4. **å·¥å…·è°ƒç”¨å¤±è´¥**
   - æ£€æŸ¥å·¥å…·ç±»æ˜¯å¦æ­£ç¡®æ³¨å†Œ
   - éªŒè¯å·¥å…·æ–¹æ³•ç­¾åæ˜¯å¦ç¬¦åˆè§„èŒƒ
   - ç¡®è®¤AIæ¨¡å‹æ˜¯å¦æ­£ç¡®ç†è§£å·¥å…·ç”¨é€”
   - æŸ¥çœ‹æ—¥å¿—ä¸­çš„å·¥å…·è°ƒç”¨è¯·æ±‚å’Œå“åº”

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤GitHub Issue: https://github.com/yjmyzz/langchain4j-study/issues
- ä½œè€…åšå®¢: http://yjmyzz.cnblogs.com
- ä½œè€…: è©ææ ‘ä¸‹çš„æ¨è¿‡

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ [LangChain4j](https://github.com/langchain4j/langchain4j) å¼€æºé¡¹ç›®æä¾›çš„å¼ºå¤§æ”¯æŒï¼

ç‰¹åˆ«æ„Ÿè°¢ä»¥ä¸‹å®˜æ–¹æ–‡æ¡£èµ„æºï¼š
- [LangChain4j ä¸­æ–‡æ–‡æ¡£](https://docs.langchain4j.info/) - ä¸ºJavaåº”ç”¨èµ‹èƒ½å¤§æ¨¡å‹èƒ½åŠ›çš„å®˜æ–¹ä¸­æ–‡æŒ‡å—
- [LangChain4j è‹±æ–‡æ–‡æ¡£](https://docs.langchain4j.dev/) - å®˜æ–¹è‹±æ–‡æ–‡æ¡£ï¼Œæä¾›å®Œæ•´çš„æŠ€æœ¯å‚è€ƒ
- [Ollamaå®˜ç½‘](https://ollama.ai/) - æœ¬åœ°å¤§è¯­è¨€æ¨¡å‹è¿è¡Œç¯å¢ƒ

## âš ï¸ é‡è¦è¯´æ˜

### Java 25 å…¼å®¹æ€§

é¡¹ç›®ä½¿ç”¨ Java 25 è¿›è¡Œå¼€å‘ã€‚ç”±äº Java 25 æ˜¯è¾ƒæ–°çš„ç‰ˆæœ¬ï¼ŒæŸäº›å·¥å…·å¯èƒ½å°šæœªå®Œå…¨æ”¯æŒï¼š

- **Lombok**: å½“å‰ç‰ˆæœ¬çš„ Lombok (1.18.36) ä¸ Java 25 å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œé¡¹ç›®å·²ç§»é™¤ Lombok æ³¨è§£å¤„ç†å™¨çš„ä½¿ç”¨
- æ‰€æœ‰æ—¥å¿—è®°å½•ä½¿ç”¨æ ‡å‡†çš„ SLF4J Loggerï¼Œä¸ä¾èµ– Lombok çš„ `@Slf4j` æ³¨è§£
- å¦‚æœé‡åˆ°ç¼–è¯‘é—®é¢˜ï¼Œè¯·ç¡®ä¿ä½¿ç”¨ JDK 25

### å·¥å…·è°ƒç”¨è¯´æ˜

é¡¹ç›®æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ LangChain4j å®ç° AI å·¥å…·è°ƒç”¨åŠŸèƒ½ï¼š

1. **å·¥å…·å®šä¹‰**: ä½¿ç”¨ `@Tool` æ³¨è§£å®šä¹‰å¯è¢«AIè°ƒç”¨çš„å·¥å…·æ–¹æ³•
2. **å·¥å…·æ³¨å†Œ**: é€šè¿‡é…ç½®ç±»å°†å·¥å…·æ³¨å†Œä¸ºSpring Bean
3. **å·¥å…·è°ƒç”¨**: æ”¯æŒç›´æ¥è°ƒç”¨å’ŒAIè¾…åŠ©è°ƒç”¨ä¸¤ç§æ–¹å¼
4. **AIé›†æˆ**: AIæ¨¡å‹å¯ä»¥ç†è§£å·¥å…·çš„åŠŸèƒ½å¹¶è‡ªåŠ¨è°ƒç”¨

---

**æ³¨æ„**: è¯·ç¡®ä¿åœ¨ä½¿ç”¨å‰å·²æ­£ç¡®å®‰è£…å’Œé…ç½®OllamaæœåŠ¡ã€‚
